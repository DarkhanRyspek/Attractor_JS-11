create or replace procedure opt_ins_finsboll(
  D_ID    in     dtype. RecordID     %Type,
  O_ID    in     dtype. RecordID     %Type,
  R_DET   in     dtype. String      %Type,
  S_CODE  in     dtype. String      %Type
) is


begin

   INSERT INTO ows.doc(
                ACQ_REF_NUMBER, AMND_DATE, AMND_OFFICER,AMND_STATE,AUTH_CODE,DOC__ORIG__ID,DOC__PREV__ID,DOC__SUMM__ID,IS_AUTHORIZATION,MERCHANT_ID,OUTWARD_STATUS,POSTING_DATE,POSTING_STATUS,
REASON_DETAILS,REC_MEMBER_ID,REQUEST_CATEGORY,RET_REF_NUMBER,RETURN_CODE,S_CAT,SERVICE_CLASS,SETTL_AMOUNT,SETTL_CURR,SIC_CODE,SOURCE_CHANNEL,SOURCE_CODE,SOURCE_FEE_CODE,
SOURCE_MEMBER_ID,SOURCE_NUMBER,SOURCE_REG_NUM,SOURCE_SPC,T_CAT,TARGET_CHANNEL,TARGET_CONTRACT,TARGET_FEE_CODE,TARGET_MEMBER_ID,TARGET_NUMBER,TRANS_AMOUNT,TRANS_CITY,TRANS_CONDITION,
                TRANS_COUNTRY,TRANS_CURR,TRANS_DATE,TRANS_DETAILS,TRANS_TYPE)

    select d.ACQ_REF_NUMBER, sysdate, O_ID,d.AMND_STATE,d.AUTH_CODE,d.DOC__ORIG__ID,d.DOC__PREV__ID,d.DOC__SUMM__ID,'N',d.MERCHANT_ID,'W',null,'W',
R_DET,d.REC_MEMBER_ID,'P',d.RET_REF_NUMBER,'0',d.S_CAT,d.SERVICE_CLASS,d.SETTL_AMOUNT,d.SETTL_CURR,d.SIC_CODE,d.SOURCE_CHANNEL,S_CODE,d.SOURCE_FEE_CODE,
d.SOURCE_MEMBER_ID,d.SOURCE_NUMBER,d.SOURCE_REG_NUM,d.SOURCE_SPC,d.T_CAT,d.TARGET_CHANNEL,d.TARGET_CONTRACT,d.TARGET_FEE_CODE,d.TARGET_MEMBER_ID,d.TARGET_NUMBER,
d.TRANS_AMOUNT,d.TRANS_CITY,d.TRANS_CONDITION,d.TRANS_COUNTRY,d.TRANS_CURR,d.TRANS_DATE,d.TRANS_DETAILS,d.TRANS_TYPE
   from ows.doc d where d.id=D_ID and d.amnd_state = 'A';
                commit;

end;
